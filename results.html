<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø´Ø§Ø±Ùƒ Ù†ØªÙŠØ¬ØªÙƒ â€” Ù…Ø¯Ø§Ø±Ùƒ Ø§Ù„Ù†Ø®Ø¨Ø©</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#08051a;font-family:'Tajawal',sans-serif;color:white;min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:28px 16px 48px}
body::before{content:'';position:fixed;inset:0;background:radial-gradient(ellipse 70% 50% at 20% 10%,rgba(99,102,241,0.18) 0%,transparent 70%),radial-gradient(ellipse 60% 50% at 80% 90%,rgba(168,85,247,0.14) 0%,transparent 70%);pointer-events:none;z-index:0}

.page-title{font-family:'Cairo',sans-serif;font-size:24px;font-weight:900;margin-bottom:6px;position:relative}
.page-sub{color:rgba(196,181,253,0.45);font-size:13px;margin-bottom:28px;position:relative}

.panel{width:100%;max-width:400px;background:rgba(255,255,255,0.04);border:1px solid rgba(139,92,246,0.18);border-radius:22px;padding:22px;margin-bottom:16px;position:relative}
.panel-title{font-size:11px;letter-spacing:3px;color:rgba(196,181,253,0.35);margin-bottom:16px;font-weight:500}

/* ØªÙˆggles */
.row{display:flex;justify-content:space-between;align-items:center;padding:9px 0;border-bottom:1px solid rgba(255,255,255,0.04)}
.row:last-of-type{border:none}
.row-label{font-size:14px;color:rgba(255,255,255,0.75)}
.sw{width:46px;height:26px;border-radius:13px;border:none;cursor:pointer;position:relative;transition:.3s;background:rgba(255,255,255,0.1)}
.sw.on{background:linear-gradient(135deg,#6366f1,#8b5cf6)}
.sw::after{content:'';position:absolute;width:20px;height:20px;background:white;border-radius:50%;top:3px;left:3px;transition:.3s;box-shadow:0 1px 4px rgba(0,0,0,0.3)}
.sw.on::after{left:23px}

.name-field{width:100%;background:rgba(255,255,255,0.06);border:1px solid rgba(139,92,246,0.22);border-radius:14px;padding:11px 16px;color:white;font-family:'Tajawal',sans-serif;font-size:15px;margin-top:12px;outline:none;text-align:right;transition:.2s}
.name-field:focus{border-color:rgba(139,92,246,0.55);background:rgba(99,102,241,0.08)}
.name-field::placeholder{color:rgba(196,181,253,0.25)}

/* Ù…Ø¹Ø§ÙŠÙ†Ø© */
.preview-box{width:100%;max-width:400px;margin-bottom:18px;position:relative}
.preview-label{font-size:11px;letter-spacing:3px;color:rgba(196,181,253,0.35);margin-bottom:12px;font-weight:500}
#previewCanvas{width:100%;border-radius:18px;border:1px solid rgba(139,92,246,0.22);display:block;box-shadow:0 20px 60px rgba(0,0,0,0.5)}

/* Ø£Ø²Ø±Ø§Ø± */
.btns{display:flex;gap:10px;width:100%;max-width:400px}
.btn-main{flex:1;padding:15px;border-radius:16px;font-family:'Tajawal',sans-serif;font-weight:900;font-size:15px;cursor:pointer;border:none;background:linear-gradient(135deg,#6366f1,#8b5cf6);color:white;transition:.2s;letter-spacing:.3px}
.btn-main:active{transform:scale(0.97)}
.btn-sec{padding:15px 18px;border-radius:16px;font-family:'Tajawal',sans-serif;font-weight:700;font-size:14px;cursor:pointer;border:1px solid rgba(139,92,246,0.25);background:rgba(99,102,241,0.08);color:rgba(196,181,253,0.8);transition:.2s}
.btn-sec:active{background:rgba(99,102,241,0.18)}

.back{margin-top:22px;color:rgba(196,181,253,0.25);font-size:13px;cursor:pointer;transition:.2s}
.back:hover{color:rgba(196,181,253,0.55)}
canvas{display:none}
</style>
</head>
<body>

<p class="page-title">Ø´Ø§Ø±Ùƒ Ø¥Ù†Ø¬Ø§Ø²Ùƒ ğŸ†</p>
<p class="page-sub">Ø§Ø®ØªØ§Ø± ÙˆØ´ ØªØ­Ø¨ ÙŠØ¸Ù‡Ø±</p>

<!-- Ø®ÙŠØ§Ø±Ø§Øª -->
<div class="panel">
  <p class="panel-title">Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØµÙˆØ±Ø©</p>
  <div class="row"><span class="row-label">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø³Ø¨Ø©</span><button class="sw on" id="sPct" onclick="tog('sPct')"></button></div>
  <div class="row"><span class="row-label">Ø¥Ø¸Ù‡Ø§Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</span><button class="sw on" id="sCnt" onclick="tog('sCnt')"></button></div>
  <div class="row"><span class="row-label">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø§Ø³Ù…</span><button class="sw on" id="sName" onclick="tog('sName')"></button></div>
  <div id="nameWrap">
    <input class="name-field" id="nameVal" placeholder="Ø§Ø³Ù…Ùƒ Ø£Ùˆ Ù„Ù‚Ø¨Ùƒ..." maxlength="25" oninput="draw()">
  </div>
</div>

<!-- Ù…Ø¹Ø§ÙŠÙ†Ø© -->
<div class="preview-box">
  <p class="preview-label">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø©</p>
  <canvas id="previewCanvas"></canvas>
</div>

<div class="btns">
  <button class="btn-main" onclick="dl()">â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„ ÙˆØ´Ø§Ø±Ùƒ</button>
  <button class="btn-sec" onclick="cp()">Ù†Ø³Ø®</button>
</div>

<p class="back" onclick="history.back()">â† Ø±Ø¬ÙˆØ¹</p>
<canvas id="C"></canvas>

<script>
var W=1080,H=1920;
var R=JSON.parse(localStorage.getItem('quiz_results')||'{}');
var ok=R.correct||0, bad=R.wrong||0, tot=R.total||10, pct=R.percentage||0, sec=R.section||'';
var secN={'quant':'Ø§Ù„Ù‚Ø¯Ø±Ø§Øª Ø§Ù„ÙƒÙ…ÙŠØ©','verbal':'Ø§Ù„Ù‚Ø¯Ø±Ø§Øª Ø§Ù„Ù„ÙØ¸ÙŠØ©','tahsili':'Ø§Ù„ØªØ­ØµÙŠÙ„ÙŠ','mix':'Ø§Ù„Ù‚Ø¯Ø±Ø§Øª'};

// Ù†Ø¬ÙˆÙ… Ø«Ø§Ø¨ØªØ©
var ST=[];for(var i=0;i<140;i++)ST.push({x:Math.random()*W,y:Math.random()*H,r:Math.random()*1.6+0.2,o:Math.random()*0.5+0.08});

// Ø§Ø³Ù… Ø§ÙØªØ±Ø§Ø¶ÙŠ
try{var u=JSON.parse(localStorage.getItem('khawariz_user')||'{}');var dn=u.name||(u.email?u.email.split('@')[0]:'');document.getElementById('nameVal').value=dn;}catch(e){}

function tog(id){
  var el=document.getElementById(id);el.classList.toggle('on');
  if(id==='sName')document.getElementById('nameWrap').style.display=el.classList.contains('on')?'block':'none';
  draw();
}
function on(id){return document.getElementById(id).classList.contains('on');}

function rr(ctx,x,y,w,h,r){ctx.beginPath();ctx.moveTo(x+r,y);ctx.lineTo(x+w-r,y);ctx.quadraticCurveTo(x+w,y,x+w,y+r);ctx.lineTo(x+w,y+h-r);ctx.quadraticCurveTo(x+w,y+h,x+w-r,y+h);ctx.lineTo(x+r,y+h);ctx.quadraticCurveTo(x,y+h,x,y+h-r);ctx.lineTo(x,y+r);ctx.quadraticCurveTo(x,y,x+r,y);ctx.closePath();}

// Ù†ØµÙˆØµ Ø§Ù„ÙØ®Ø± Ø­Ø³Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙˆØ­Ø³Ø¨ Ø§Ù„Ù‚Ø³Ù…
function getTexts(){
  var sName=secN[sec]||'Ø§Ù„ØªØ¯Ø±ÙŠØ¨';
  var emoji=pct>=90?'ğŸ”¥':pct>=75?'âš¡ï¸':pct>=60?'ğŸ’ª':'ğŸ¯';
  var line1, line2;
  if(pct>=90){
    line1='Ø§Ù„Ø­Ù…Ø¯Ù„Ù„Ù‡ ğŸ™';
    line2='Ù…Ø§ Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡ Ø§Ù†Ø¬Ø²Øª ØªØ¯Ø±ÙŠØ¨ÙŠ ÙÙŠ '+emoji;
  } else if(pct>=75){
    line1='Ù…Ø§Ø´ÙŠ Ø§Ù„Ø­Ø§Ù„ '+emoji;
    line2='Ø§Ù†Ø¬Ø²Øª Ø¬Ù„Ø³Ø© ØªØ¯Ø±ÙŠØ¨ ÙÙŠ';
  } else if(pct>=60){
    line1='Ø´ØºÙ‘Ø§Ù„ÙŠÙ† '+emoji;
    line2='Ù…Ø§ ØªÙˆÙ‚ÙØŒ Ø§Ù†Ø¬Ø²Øª Ø¬Ù„Ø³Ø© ÙÙŠ';
  } else {
    line1='Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø¯Ø§ÙŠÙ…Ø§ Ø§Ù„Ø£ØµØ¹Ø¨ '+emoji;
    line2='Ø¨Ø¯ÙŠØª Ø±Ø­Ù„ØªÙŠ ÙÙŠ';
  }
  return {line1:line1, line2:line2, sName:sName, emoji:emoji};
}

function draw(){
  var cv=document.getElementById('C');cv.width=W;cv.height=H;
  var ctx=cv.getContext('2d');
  var pColor=pct>=90?'#4ade80':pct>=75?'#c4b5fd':pct>=60?'#fbbf24':'#f87171';
  var pGlow=pct>=90?'rgba(74,222,128,':pct>=75?'rgba(196,181,253,':pct>=60?'rgba(251,191,36,':'rgba(248,113,113,';
  var T=getTexts();

  // â”â”â” Ø®Ù„ÙÙŠØ© â”â”â”
  var bg=ctx.createLinearGradient(0,0,W,H);
  bg.addColorStop(0,'#08051a');bg.addColorStop(0.4,'#0f0a28');bg.addColorStop(0.75,'#160e35');bg.addColorStop(1,'#08051a');
  ctx.fillStyle=bg;ctx.fillRect(0,0,W,H);

  // Ù†Ø¬ÙˆÙ…
  ST.forEach(function(s){ctx.fillStyle='rgba(255,255,255,'+s.o+')';ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.fill();});

  // ÙˆÙ‡Ø¬ Ø£Ø¹Ù„Ù‰ ÙŠØ³Ø§Ø±
  var g1=ctx.createRadialGradient(200,250,0,200,250,550);g1.addColorStop(0,'rgba(99,102,241,0.2)');g1.addColorStop(1,'transparent');ctx.fillStyle=g1;ctx.fillRect(0,0,W,H);
  // ÙˆÙ‡Ø¬ Ø£Ø³ÙÙ„ ÙŠÙ…ÙŠÙ†
  var g2=ctx.createRadialGradient(900,1650,0,900,1650,500);g2.addColorStop(0,'rgba(168,85,247,0.16)');g2.addColorStop(1,'transparent');ctx.fillStyle=g2;ctx.fillRect(0,0,W,H);
  // ÙˆÙ‡Ø¬ Ø§Ù„Ù†ØªÙŠØ¬Ø©
  var g3=ctx.createRadialGradient(W/2,920,0,W/2,920,380);g3.addColorStop(0,pGlow+'0.12)');g3.addColorStop(1,'transparent');ctx.fillStyle=g3;ctx.fillRect(0,0,W,H);

  // â”â”â” Ø®Ø· Ø²Ø®Ø±ÙÙŠ Ø¹Ù„ÙˆÙŠ â”â”â”
  var topLine=ctx.createLinearGradient(0,0,W,0);
  topLine.addColorStop(0,'transparent');topLine.addColorStop(0.3,pColor.replace(')',',0.7)').replace('#','rgba(').replace('rgba(','rgba('));
  // Ø£Ø¨Ø³Ø·:
  ctx.strokeStyle=pColor;ctx.globalAlpha=0.25;ctx.lineWidth=2;
  ctx.beginPath();ctx.moveTo(0,4);ctx.lineTo(W,4);ctx.stroke();
  ctx.globalAlpha=1;

  ctx.textAlign='center';

  // â”â”â” Ø´Ø¹Ø§Ø± Ø£Ø¹Ù„Ù‰ â”â”â”
  // ØªØ§Ø¬
  var tx=W/2, ty=320;
  ctx.save();ctx.strokeStyle='rgba(165,180,252,0.85)';ctx.lineWidth=3.5;ctx.lineJoin='round';ctx.lineCap='round';
  ctx.beginPath();ctx.moveTo(tx-70,ty+50);ctx.lineTo(tx-70,ty-5);ctx.lineTo(tx-22,ty+28);ctx.lineTo(tx,ty-40);ctx.lineTo(tx+22,ty+28);ctx.lineTo(tx+70,ty-5);ctx.lineTo(tx+70,ty+50);ctx.closePath();ctx.stroke();
  ctx.beginPath();ctx.moveTo(tx-70,ty+62);ctx.lineTo(tx+70,ty+62);ctx.stroke();
  ctx.fillStyle='#a5b4fc';ctx.beginPath();ctx.arc(tx-70,ty-5,6,0,Math.PI*2);ctx.fill();
  ctx.fillStyle='#c4b5fd';ctx.beginPath();ctx.arc(tx,ty-40,6,0,Math.PI*2);ctx.fill();
  ctx.fillStyle='#a5b4fc';ctx.beginPath();ctx.arc(tx+70,ty-5,6,0,Math.PI*2);ctx.fill();
  ctx.restore();

  ctx.fillStyle='rgba(255,255,255,0.88)';ctx.font='bold 60px Cairo, Arial';ctx.fillText('Ù…Ø¯Ø§Ø±Ùƒ Ø§Ù„Ù†Ø®Ø¨Ø©',W/2,440);
  ctx.fillStyle='rgba(196,181,253,0.35)';ctx.font='500 30px Tajawal, Arial';ctx.fillText('Ø­ÙŠØ« ÙŠÙØµÙ†Ø¹ Ø§Ù„ØªÙ…ÙŠÙ‘Ø²',W/2,485);

  // ÙØ§ØµÙ„
  ctx.strokeStyle='rgba(139,92,246,0.22)';ctx.lineWidth=1;
  ctx.beginPath();ctx.moveTo(160,530);ctx.lineTo(W-160,530);ctx.stroke();

  // â”â”â” ÙƒÙ„Ø§Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ â”â”â”
  // Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
  ctx.fillStyle='rgba(255,255,255,0.03)';
  rr(ctx,70,570,W-140,780,48);ctx.fill();
  ctx.strokeStyle='rgba(139,92,246,0.18)';ctx.lineWidth=1.5;
  rr(ctx,70,570,W-140,780,48);ctx.stroke();

  // Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø£ÙˆÙ„ â€” Ø¨Ù„Ø³Ø§Ù† Ø§Ù„Ø·Ø§Ù„Ø¨
  ctx.fillStyle='rgba(255,255,255,0.95)';
  ctx.font='900 72px Cairo, Arial';
  ctx.fillText(T.line1,W/2,670);

  // Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ
  ctx.fillStyle='rgba(196,181,253,0.65)';
  ctx.font='500 38px Tajawal, Arial';
  ctx.fillText(T.line2,W/2,740);

  // Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù…
  ctx.fillStyle='rgba(255,255,255,0.8)';
  ctx.font='bold 52px Cairo, Arial';
  ctx.fillText(T.sName,W/2,812);

  // â”â”â” Ø§Ù„Ù†ØªÙŠØ¬Ø© â€” Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙƒØ¨ÙŠØ± â”â”â”
  if(on('sPct')){
    // Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„Ø±Ù‚Ù…
    ctx.fillStyle=pGlow+'0.1)';ctx.beginPath();ctx.arc(W/2,985,210,0,Math.PI*2);ctx.fill();
    ctx.strokeStyle=pColor;ctx.globalAlpha=0.2;ctx.lineWidth=1.5;ctx.beginPath();ctx.arc(W/2,985,210,0,Math.PI*2);ctx.stroke();ctx.globalAlpha=1;

    ctx.fillStyle=pColor;
    ctx.font='900 220px Cairo, Arial';
    ctx.fillText(pct+'%',W/2,1060);

    if(on('sCnt')){
      ctx.fillStyle='rgba(255,255,255,0.45)';
      ctx.font='500 40px Tajawal, Arial';
      ctx.fillText(ok+' ØµØ­ Ù…Ù† Ø£ØµÙ„ '+tot+' Ø³Ø¤Ø§Ù„',W/2,1140);
    }
  } else if(on('sCnt')){
    ctx.fillStyle=pColor;ctx.font='900 130px Cairo, Arial';ctx.fillText(ok+'/'+tot,W/2,1020);
    ctx.fillStyle='rgba(255,255,255,0.45)';ctx.font='500 40px Tajawal, Arial';ctx.fillText('Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©',W/2,1090);
  }

  // ÙØ§ØµÙ„
  ctx.strokeStyle='rgba(139,92,246,0.18)';ctx.lineWidth=1;
  ctx.beginPath();ctx.moveTo(160,1220);ctx.lineTo(W-160,1220);ctx.stroke();

  // â”â”â” Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ â”â”â”
  if(on('sName')){
    var nm=document.getElementById('nameVal').value.trim();
    if(nm){
      ctx.font='bold 40px Tajawal, Arial';
      var nmW=ctx.measureText(nm).width+90;
      ctx.fillStyle='rgba(99,102,241,0.14)';
      rr(ctx,W/2-nmW/2,1265,nmW,80,40);ctx.fill();
      ctx.strokeStyle='rgba(99,102,241,0.3)';ctx.lineWidth=1;
      rr(ctx,W/2-nmW/2,1265,nmW,80,40);ctx.stroke();
      ctx.fillStyle='rgba(255,255,255,0.8)';
      ctx.fillText(nm,W/2,1318);
    }
  }

  // â”â”â” Ø¯Ø¹ÙˆØ© Ù„Ù„ØªØ³Ø¬ÙŠÙ„ â€” Ù…Ù†Ø·Ù‚Ø© Ø³ÙÙ„ÙŠØ© â”â”â”
  // Ø®Ø· ÙØ§ØµÙ„
  ctx.strokeStyle='rgba(139,92,246,0.15)';ctx.lineWidth=1;
  ctx.beginPath();ctx.moveTo(160,1430);ctx.lineTo(W-160,1430);ctx.stroke();

  ctx.fillStyle='rgba(196,181,253,0.3)';ctx.font='500 30px Tajawal, Arial';
  ctx.fillText('ØªØ¯Ø±Ù‘Ø¨ Ù…Ø¹ÙŠ',W/2,1510);

  ctx.fillStyle='rgba(165,180,252,0.75)';ctx.font='bold 52px Cairo, Arial';
  ctx.fillText('madarekelite.com',W/2,1580);

  ctx.fillStyle='rgba(196,181,253,0.2)';ctx.font='26px Tajawal, Arial';
  ctx.fillText('Ù…Ù†ØµØ© ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù‚Ø¯Ø±Ø§Øª ÙˆØ§Ù„ØªØ­ØµÙŠÙ„ÙŠ',W/2,1638);

  // Ø´Ø¹Ø§Ø± Ø£Ø³ÙÙ„ ØµØºÙŠØ±
  ctx.fillStyle='rgba(196,181,253,0.1)';ctx.font='22px Tajawal, Arial';
  ctx.fillText('Ù…Ø¯Ø§Ø±Ùƒ Ø§Ù„Ù†Ø®Ø¨Ø© Â© 2026',W/2,1840);

  // Ù…Ø¹Ø§ÙŠÙ†Ø©
  var pv=document.getElementById('previewCanvas');pv.width=W;pv.height=H;
  pv.getContext('2d').drawImage(cv,0,0);
}

function dl(){
  document.getElementById('C').toBlob(function(b){
    var a=document.createElement('a');a.href=URL.createObjectURL(b);a.download='Ù†ØªÙŠØ¬ØªÙŠ-Ù…Ø¯Ø§Ø±Ùƒ.png';a.click();
  },'image/png');
}
async function cp(){
  try{
    document.getElementById('C').toBlob(async function(b){
      await navigator.clipboard.write([new ClipboardItem({'image/png':b})]);
      var btn=document.querySelector('.btn-sec');btn.textContent='âœ…';
      setTimeout(function(){btn.textContent='Ù†Ø³Ø®';},2000);
    },'image/png');
  }catch(e){alert('Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªÙ†Ø²ÙŠÙ„ ÙˆØ§Ø±ÙØ¹Ù‡Ø§ Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø²');}
}

draw();
document.getElementById('nameVal').addEventListener('input',draw);
</script>
</body>
</html>
