<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø´Ø§Ø±Ùƒ Ø¥Ù†Ø¬Ø§Ø²Ùƒ â€” Ù…Ø¯Ø§Ø±Ùƒ Ø§Ù„Ù†Ø®Ø¨Ø©</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#070416;font-family:'Tajawal',sans-serif;color:white;min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:28px 16px 48px}
body::before{content:'';position:fixed;inset:0;background:radial-gradient(ellipse 80% 40% at 15% 5%,rgba(99,102,241,0.2) 0%,transparent 65%),radial-gradient(ellipse 60% 50% at 85% 95%,rgba(168,85,247,0.15) 0%,transparent 65%);pointer-events:none}

.page-title{font-family:'Cairo',sans-serif;font-size:26px;font-weight:900;margin-bottom:5px;position:relative;text-align:center}
.page-sub{color:rgba(196,181,253,0.4);font-size:13px;margin-bottom:26px;position:relative;text-align:center}

.panel{width:100%;max-width:420px;background:rgba(255,255,255,0.035);border:1px solid rgba(139,92,246,0.2);border-radius:22px;padding:20px;margin-bottom:14px;position:relative}
.panel-title{font-size:11px;letter-spacing:3px;color:rgba(196,181,253,0.3);margin-bottom:14px;font-weight:500}

/* Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¬Ù…Ù„Ø© */
.phrases{display:flex;flex-direction:column;gap:8px}
.phrase-btn{width:100%;padding:13px 18px;border-radius:14px;border:1px solid rgba(139,92,246,0.18);background:rgba(255,255,255,0.03);color:rgba(255,255,255,0.75);font-family:'Tajawal',sans-serif;font-size:15px;cursor:pointer;text-align:right;transition:.2s;line-height:1.4}
.phrase-btn:hover{background:rgba(99,102,241,0.1);border-color:rgba(139,92,246,0.35);color:white}
.phrase-btn.selected{background:rgba(99,102,241,0.15);border-color:rgba(139,92,246,0.6);color:white}

/* toggles */
.row{display:flex;justify-content:space-between;align-items:center;padding:9px 0;border-bottom:1px solid rgba(255,255,255,0.04)}
.row:last-of-type{border:none}
.row-label{font-size:14px;color:rgba(255,255,255,0.7)}
.sw{width:46px;height:26px;border-radius:13px;border:none;cursor:pointer;position:relative;transition:.3s;background:rgba(255,255,255,0.1);flex-shrink:0}
.sw.on{background:linear-gradient(135deg,#6366f1,#8b5cf6)}
.sw::after{content:'';position:absolute;width:20px;height:20px;background:white;border-radius:50%;top:3px;left:3px;transition:.3s;box-shadow:0 1px 4px rgba(0,0,0,0.3)}
.sw.on::after{left:23px}
.name-field{width:100%;background:rgba(255,255,255,0.05);border:1px solid rgba(139,92,246,0.2);border-radius:14px;padding:11px 16px;color:white;font-family:'Tajawal',sans-serif;font-size:15px;margin-top:12px;outline:none;text-align:right;transition:.2s}
.name-field:focus{border-color:rgba(139,92,246,0.5);background:rgba(99,102,241,0.07)}
.name-field::placeholder{color:rgba(196,181,253,0.22)}

/* Ù…Ø¹Ø§ÙŠÙ†Ø© */
.preview-box{width:100%;max-width:420px;margin-bottom:16px}
.preview-label{font-size:11px;letter-spacing:3px;color:rgba(196,181,253,0.3);margin-bottom:10px;font-weight:500}
#previewCanvas{width:100%;border-radius:18px;border:1px solid rgba(139,92,246,0.2);display:block;box-shadow:0 16px 50px rgba(0,0,0,0.5)}

.btns{display:flex;gap:10px;width:100%;max-width:420px}
.btn-main{flex:1;padding:15px;border-radius:16px;font-family:'Tajawal',sans-serif;font-weight:900;font-size:15px;cursor:pointer;border:none;background:linear-gradient(135deg,#6366f1,#8b5cf6);color:white;transition:.15s}
.btn-main:active{transform:scale(0.97)}
.btn-dl{padding:15px 20px;border-radius:16px;font-family:'Tajawal',sans-serif;font-weight:700;font-size:14px;cursor:pointer;border:1px solid rgba(139,92,246,0.25);background:rgba(99,102,241,0.07);color:rgba(196,181,253,0.8);transition:.15s}
.back{margin-top:20px;color:rgba(196,181,253,0.22);font-size:13px;cursor:pointer;transition:.2s}
.back:hover{color:rgba(196,181,253,0.5)}
canvas{display:none}
</style>
</head>
<body>

<p class="page-title">Ø´Ø§Ø±Ùƒ Ø¥Ù†Ø¬Ø§Ø²Ùƒ ğŸ”¥</p>
<p class="page-sub">ØµÙ…Ù‘Ù… ØµÙˆØ±ØªÙƒ ÙˆØ´Ø§Ø±ÙƒÙ‡Ø§</p>

<!-- Ù…Ø¹Ø§ÙŠÙ†Ø© Ø£Ø¹Ù„Ù‰ -->
<div class="preview-box">
  <p class="preview-label">Ù…Ø¹Ø§ÙŠÙ†Ø©</p>
  <canvas id="previewCanvas"></canvas>
</div>

<div class="btns">
  <button class="btn-main" onclick="shareNative()">â†—ï¸ Ø´Ø§Ø±Ùƒ</button>
  <button class="btn-dl" onclick="dl()">â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„</button>
</div>

<!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¬Ù…Ù„Ø© -->
<div class="panel" style="margin-top:20px">
  <p class="panel-title">Ø§Ø®ØªØ§Ø± Ø¬Ù…Ù„ØªÙƒ</p>
  <div class="phrases" id="phrases">
    <button class="phrase-btn selected" onclick="selectPhrase(this,'Ø§Ù„Ø­Ù…Ø¯Ù„Ù„Ù‡ ğŸ™\nØ§Ù†Ø¬Ø²Øª ØªØ¯Ø±ÙŠØ¨ÙŠ Ø§Ù„ÙŠÙˆÙ…')">Ø§Ù„Ø­Ù…Ø¯Ù„Ù„Ù‡ ğŸ™ Ø§Ù†Ø¬Ø²Øª ØªØ¯Ø±ÙŠØ¨ÙŠ Ø§Ù„ÙŠÙˆÙ…</button>
    <button class="phrase-btn" onclick="selectPhrase(this,'Ù…Ø§ ØªÙˆÙ‚ÙØª\nØ¹Ù† Ø§Ù„ØªØ·ÙˆØ± ğŸ”¥')">Ù…Ø§ ØªÙˆÙ‚ÙØª Ø¹Ù† Ø§Ù„ØªØ·ÙˆØ± ğŸ”¥</button>
    <button class="phrase-btn" onclick="selectPhrase(this,'Ø¹Ù„Ù‰ Ø·Ø±ÙŠÙ‚\nØ§Ù„Ù‚Ø¨ÙˆÙ„ ğŸ¯')">Ø¹Ù„Ù‰ Ø·Ø±ÙŠÙ‚ Ø§Ù„Ù‚Ø¨ÙˆÙ„ ğŸ¯</button>
    <button class="phrase-btn" onclick="selectPhrase(this,'ÙƒÙ„ ÙŠÙˆÙ…\nØ£Ù‚ÙˆÙ‰ Ù…Ù† Ø£Ù…Ø³ âš¡ï¸')">ÙƒÙ„ ÙŠÙˆÙ… Ø£Ù‚ÙˆÙ‰ Ù…Ù† Ø£Ù…Ø³ âš¡ï¸</button>
    <button class="phrase-btn" onclick="selectPhrase(this,'Ø´ØºÙ‘Ø§Ù„ Ø¹Ù„Ù‰\nnÙ†ÙØ³ÙŠ ÙˆÙ…Ø§ ÙˆÙ‚ÙØª ğŸ’ª')">Ø´ØºÙ‘Ø§Ù„ Ø¹Ù„Ù‰ Ù†ÙØ³ÙŠ ÙˆÙ…Ø§ ÙˆÙ‚ÙØª ğŸ’ª</button>
    <button class="phrase-btn" onclick="selectPhrase(this,'Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ÙŠÙˆÙ…\nØ§Ø³ØªØ«Ù…Ø§Ø± Ø¨ÙƒØ±Ù‡ ğŸ†')">Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ÙŠÙˆÙ… Ø§Ø³ØªØ«Ù…Ø§Ø± Ø¨ÙƒØ±Ù‡ ğŸ†</button>
  </div>
</div>

<!-- Ø®ÙŠØ§Ø±Ø§Øª -->
<div class="panel">
  <p class="panel-title">Ø®ÙŠØ§Ø±Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</p>
  <div class="row"><span class="row-label">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø³Ø¨Ø©</span><button class="sw on" id="sPct" onclick="tog('sPct')"></button></div>
  <div class="row"><span class="row-label">Ø¥Ø¸Ù‡Ø§Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</span><button class="sw on" id="sCnt" onclick="tog('sCnt')"></button></div>
  <div class="row"><span class="row-label">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø§Ø³Ù…</span><button class="sw on" id="sName" onclick="tog('sName')"></button></div>
  <div id="nameWrap">
    <input class="name-field" id="nameVal" placeholder="Ø§Ø³Ù…Ùƒ Ø£Ùˆ Ù„Ù‚Ø¨Ùƒ..." maxlength="22" oninput="draw()">
  </div>
</div>


<p class="back" onclick="history.back()">â† Ø±Ø¬ÙˆØ¹</p>
<canvas id="C"></canvas>

<script>
var W=1080,H=1920;
var R=JSON.parse(localStorage.getItem('quiz_results')||'{}');
var ok=R.correct||0,tot=R.total||10,pct=R.percentage||0,sec=R.section||'';
var secN={'quant':'Ø§Ù„Ù‚Ø¯Ø±Ø§Øª Ø§Ù„ÙƒÙ…ÙŠØ©','verbal':'Ø§Ù„Ù‚Ø¯Ø±Ø§Øª Ø§Ù„Ù„ÙØ¸ÙŠØ©','tahsili':'Ø§Ù„ØªØ­ØµÙŠÙ„ÙŠ','mix':'Ø§Ù„Ù‚Ø¯Ø±Ø§Øª'};
// Ø§Ù„Ø¬Ù†Ø³
var gender='male';
try{var ud=JSON.parse(localStorage.getItem('khawariz_user')||'{}');gender=ud.gender||'male';}catch(e){}
var isFemale=(gender==='female');

var PHRASES=isFemale?[
  {label:'Ø§Ù„Ø­Ù…Ø¯Ù„Ù„Ù‡ ğŸ™ Ø§Ù†Ø¬Ø²Øª ØªØ¯Ø±ÙŠØ¨ÙŠ Ø§Ù„ÙŠÙˆÙ…', val:'Ø§Ù„Ø­Ù…Ø¯Ù„Ù„Ù‡ ğŸ™\nØ§Ù†Ø¬Ø²Øª ØªØ¯Ø±ÙŠØ¨ÙŠ Ø§Ù„ÙŠÙˆÙ…'},
  {label:'Ù…Ø§ ØªÙˆÙ‚ÙØª Ø¹Ù† Ø§Ù„ØªØ·ÙˆØ± ğŸ”¥', val:'Ù…Ø§ ØªÙˆÙ‚ÙØª\nØ¹Ù† Ø§Ù„ØªØ·ÙˆØ± ğŸ”¥'},
  {label:'Ø¹Ù„Ù‰ Ø·Ø±ÙŠÙ‚ Ø§Ù„Ù‚Ø¨ÙˆÙ„ ğŸ¯', val:'Ø¹Ù„Ù‰ Ø·Ø±ÙŠÙ‚\nØ§Ù„Ù‚Ø¨ÙˆÙ„ ğŸ¯'},
  {label:'ÙƒÙ„ ÙŠÙˆÙ… Ø£Ù‚ÙˆÙ‰ Ù…Ù† Ø£Ù…Ø³ âš¡ï¸', val:'ÙƒÙ„ ÙŠÙˆÙ…\nØ£Ù‚ÙˆÙ‰ Ù…Ù† Ø£Ù…Ø³ âš¡ï¸'},
  {label:'Ø´ØºÙ‘Ø§Ù„Ø© Ø¹Ù„Ù‰ Ù†ÙØ³ÙŠ ÙˆÙ…Ø§ ÙˆÙ‚ÙØª ğŸ’ª', val:'Ø´ØºÙ‘Ø§Ù„Ø© Ø¹Ù„Ù‰\nÙ†ÙØ³ÙŠ ÙˆÙ…Ø§ ÙˆÙ‚ÙØª ğŸ’ª'},
  {label:'Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ÙŠÙˆÙ… Ø§Ø³ØªØ«Ù…Ø§Ø± Ø¨ÙƒØ±Ù‡ ğŸ†', val:'Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ÙŠÙˆÙ…\nØ§Ø³ØªØ«Ù…Ø§Ø± Ø¨ÙƒØ±Ù‡ ğŸ†'}
]:[
  {label:'Ø§Ù„Ø­Ù…Ø¯Ù„Ù„Ù‡ ğŸ™ Ø§Ù†Ø¬Ø²Øª ØªØ¯Ø±ÙŠØ¨ÙŠ Ø§Ù„ÙŠÙˆÙ…', val:'Ø§Ù„Ø­Ù…Ø¯Ù„Ù„Ù‡ ğŸ™\nØ§Ù†Ø¬Ø²Øª ØªØ¯Ø±ÙŠØ¨ÙŠ Ø§Ù„ÙŠÙˆÙ…'},
  {label:'Ù…Ø§ ØªÙˆÙ‚ÙØª Ø¹Ù† Ø§Ù„ØªØ·ÙˆØ± ğŸ”¥', val:'Ù…Ø§ ØªÙˆÙ‚ÙØª\nØ¹Ù† Ø§Ù„ØªØ·ÙˆØ± ğŸ”¥'},
  {label:'Ø¹Ù„Ù‰ Ø·Ø±ÙŠÙ‚ Ø§Ù„Ù‚Ø¨ÙˆÙ„ ğŸ¯', val:'Ø¹Ù„Ù‰ Ø·Ø±ÙŠÙ‚\nØ§Ù„Ù‚Ø¨ÙˆÙ„ ğŸ¯'},
  {label:'ÙƒÙ„ ÙŠÙˆÙ… Ø£Ù‚ÙˆÙ‰ Ù…Ù† Ø£Ù…Ø³ âš¡ï¸', val:'ÙƒÙ„ ÙŠÙˆÙ…\nØ£Ù‚ÙˆÙ‰ Ù…Ù† Ø£Ù…Ø³ âš¡ï¸'},
  {label:'Ø´ØºÙ‘Ø§Ù„ Ø¹Ù„Ù‰ Ù†ÙØ³ÙŠ ÙˆÙ…Ø§ ÙˆÙ‚ÙØª ğŸ’ª', val:'Ø´ØºÙ‘Ø§Ù„ Ø¹Ù„Ù‰\nÙ†ÙØ³ÙŠ ÙˆÙ…Ø§ ÙˆÙ‚ÙØª ğŸ’ª'},
  {label:'Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ÙŠÙˆÙ… Ø§Ø³ØªØ«Ù…Ø§Ø± Ø¨ÙƒØ±Ù‡ ğŸ†', val:'Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ÙŠÙˆÙ…\nØ§Ø³ØªØ«Ù…Ø§Ø± Ø¨ÙƒØ±Ù‡ ğŸ†'}
];

var currentPhrase=PHRASES[0].val;

function buildPhrases(){
  var cont=document.getElementById('phrases');cont.innerHTML='';
  PHRASES.forEach(function(p,i){
    var btn=document.createElement('button');
    btn.className='phrase-btn'+(i===0?' selected':'');
    btn.textContent=p.label;
    btn.onclick=(function(pv){return function(){selectPhrase(this,pv);};})(p.val);
    cont.appendChild(btn);
  });
}

// Ù†Ø¬ÙˆÙ…
var ST=[];for(var i=0;i<150;i++)ST.push({x:Math.random()*W,y:Math.random()*H,r:Math.random()*1.7+0.2,o:Math.random()*0.45+0.07});

// Ø§Ø³Ù… Ø§ÙØªØ±Ø§Ø¶ÙŠ
try{var u=JSON.parse(localStorage.getItem('khawariz_user')||'{}');document.getElementById('nameVal').value=u.name||(u.email?u.email.split('@')[0]:'');}catch(e){}

function selectPhrase(btn,phrase){
  document.querySelectorAll('.phrase-btn').forEach(function(b){b.classList.remove('selected');});
  btn.classList.add('selected');
  currentPhrase=phrase;
  draw();
}
function tog(id){var el=document.getElementById(id);el.classList.toggle('on');if(id==='sName')document.getElementById('nameWrap').style.display=el.classList.contains('on')?'block':'none';draw();}
function on(id){return document.getElementById(id).classList.contains('on');}

function rr(ctx,x,y,w,h,r){ctx.beginPath();ctx.moveTo(x+r,y);ctx.lineTo(x+w-r,y);ctx.quadraticCurveTo(x+w,y,x+w,y+r);ctx.lineTo(x+w,y+h-r);ctx.quadraticCurveTo(x+w,y+h,x+w-r,y+h);ctx.lineTo(x+r,y+h);ctx.quadraticCurveTo(x,y+h,x,y+h-r);ctx.lineTo(x,y+r);ctx.quadraticCurveTo(x,y,x+r,y);ctx.closePath();}

function draw(){
  var cv=document.getElementById('C');cv.width=W;cv.height=H;
  var ctx=cv.getContext('2d');
  var pColor=pct>=90?'#4ade80':pct>=75?'#c4b5fd':pct>=60?'#fbbf24':'#f87171';
  var pGlow=pct>=90?[74,222,128]:pct>=75?[196,181,253]:pct>=60?[251,191,36]:[248,113,113];

  // â”â”â” Ø®Ù„ÙÙŠØ© â”â”â”
  var bg=ctx.createLinearGradient(0,0,W,H);
  bg.addColorStop(0,'#07041a');bg.addColorStop(0.45,'#0e0a26');bg.addColorStop(0.8,'#140d32');bg.addColorStop(1,'#07041a');
  ctx.fillStyle=bg;ctx.fillRect(0,0,W,H);

  // Ù†Ø¬ÙˆÙ…
  ST.forEach(function(s){ctx.fillStyle='rgba(255,255,255,'+s.o+')';ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.fill();});

  // ÙˆÙ‡Ø¬ Ø£Ø¹Ù„Ù‰
  var g1=ctx.createRadialGradient(180,220,0,180,220,600);g1.addColorStop(0,'rgba(99,102,241,0.22)');g1.addColorStop(1,'transparent');ctx.fillStyle=g1;ctx.fillRect(0,0,W,H);
  // ÙˆÙ‡Ø¬ Ø£Ø³ÙÙ„
  var g2=ctx.createRadialGradient(900,1700,0,900,1700,520);g2.addColorStop(0,'rgba(168,85,247,0.17)');g2.addColorStop(1,'transparent');ctx.fillStyle=g2;ctx.fillRect(0,0,W,H);
  // ÙˆÙ‡Ø¬ Ø§Ù„Ù†ØªÙŠØ¬Ø©
  var g3=ctx.createRadialGradient(W/2,1000,0,W/2,1000,350);
  g3.addColorStop(0,'rgba('+pGlow.join(',')+',0.13)');g3.addColorStop(1,'transparent');ctx.fillStyle=g3;ctx.fillRect(0,0,W,H);

  ctx.textAlign='center';

  // â”â”â” Ø´Ø¹Ø§Ø± â”â”â”
  // ØªØ§Ø¬
  var tx=W/2,ty=290;
  ctx.save();ctx.strokeStyle='rgba(165,180,252,0.8)';ctx.lineWidth=3.5;ctx.lineJoin='round';ctx.lineCap='round';
  ctx.beginPath();ctx.moveTo(tx-72,ty+52);ctx.lineTo(tx-72,ty-2);ctx.lineTo(tx-23,ty+30);ctx.lineTo(tx,ty-42);ctx.lineTo(tx+23,ty+30);ctx.lineTo(tx+72,ty-2);ctx.lineTo(tx+72,ty+52);ctx.closePath();ctx.stroke();
  ctx.beginPath();ctx.moveTo(tx-72,ty+64);ctx.lineTo(tx+72,ty+64);ctx.stroke();
  ctx.fillStyle='#a5b4fc';ctx.beginPath();ctx.arc(tx-72,ty-2,6,0,Math.PI*2);ctx.fill();
  ctx.fillStyle='#c4b5fd';ctx.beginPath();ctx.arc(tx,ty-42,6,0,Math.PI*2);ctx.fill();
  ctx.fillStyle='#a5b4fc';ctx.beginPath();ctx.arc(tx+72,ty-2,6,0,Math.PI*2);ctx.fill();
  ctx.restore();

  ctx.fillStyle='rgba(255,255,255,0.92)';ctx.font='bold 62px Cairo, Arial';ctx.fillText('Ù…Ø¯Ø§Ø±Ùƒ Ø§Ù„Ù†Ø®Ø¨Ø©',W/2,430);
  ctx.fillStyle='rgba(196,181,253,0.38)';ctx.font='500 30px Tajawal, Arial';ctx.fillText('Ø­ÙŠØ« ÙŠÙØµÙ†Ø¹ Ø§Ù„ØªÙ…ÙŠÙ‘Ø²',W/2,476);

  // ÙØ§ØµÙ„
  ctx.strokeStyle='rgba(139,92,246,0.2)';ctx.lineWidth=1;ctx.beginPath();ctx.moveTo(155,516);ctx.lineTo(W-155,516);ctx.stroke();

  // â”â”â” Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© â”â”â”
  var lines=currentPhrase.split('\n');
  // Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¬Ù…Ù„Ø© â€” Ø¨Ø¯ÙˆÙ† Ø­Ø¯ÙˆØ¯ØŒ Ø¨Ø³ ÙˆÙ‡Ø¬ Ø®ÙÙŠÙ
  var g4=ctx.createLinearGradient(0,555,0,830);g4.addColorStop(0,'rgba(99,102,241,0.06)');g4.addColorStop(1,'rgba(168,85,247,0.04)');
  ctx.fillStyle=g4;rr(ctx,60,555,W-120,290,44);ctx.fill();

  // Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø£ÙˆÙ„
  ctx.fillStyle='rgba(255,255,255,0.95)';
  ctx.font='900 86px Cairo, Arial';
  if(lines.length>1){
    ctx.fillText(lines[0],W/2,655);
    ctx.fillText(lines[1],W/2,760);
  } else {
    // ÙƒØ³Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠ
    var words=lines[0].split(' '),line1='',line2='';
    var half=Math.ceil(words.length/2);
    line1=words.slice(0,half).join(' ');line2=words.slice(half).join(' ');
    ctx.fillText(line1,W/2,640);
    if(line2)ctx.fillText(line2,W/2,748);
  }

  // â”â”â” Ø¨Ø§Ø¯Ø¬ Ø§Ù„Ù‚Ø³Ù… â”â”â”
  var sLabel=secN[sec]||'Ø§Ù„Ù‚Ø¯Ø±Ø§Øª ÙˆØ§Ù„ØªØ­ØµÙŠÙ„ÙŠ';
  var badgeW=500, badgeH=72, badgeX=W/2-badgeW/2, badgeY=820;
  var badgeGrad=ctx.createLinearGradient(badgeX,0,badgeX+badgeW,0);
  badgeGrad.addColorStop(0,'rgba(99,102,241,0.25)');
  badgeGrad.addColorStop(1,'rgba(168,85,247,0.25)');
  ctx.fillStyle=badgeGrad;
  rr(ctx,badgeX,badgeY,badgeW,badgeH,36);ctx.fill();
  ctx.strokeStyle='rgba(139,92,246,0.45)';ctx.lineWidth=1.2;
  rr(ctx,badgeX,badgeY,badgeW,badgeH,36);ctx.stroke();
  ctx.fillStyle='rgba(196,181,253,0.85)';ctx.font='bold 32px Tajawal, Arial';
  ctx.fillText('ğŸ“š ØªØ¯Ø±ÙŠØ¨ '+sLabel,W/2,badgeY+46);

  // ÙØ§ØµÙ„ Ø±ÙÙŠØ¹
  ctx.strokeStyle='rgba(139,92,246,0.15)';ctx.lineWidth=1;ctx.beginPath();ctx.moveTo(200,910);ctx.lineTo(W-200,910);ctx.stroke();

  // â”â”â” Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© â€” Ø§Ø±ØªÙØ§Ø¹ Ø«Ø§Ø¨Øª Ø¯Ø§Ø¦Ù…Ø§Ù‹ â”â”â”
  var showP=on('sPct'),showC=on('sCnt');
  var zoneY=1030, zoneH=320;

  // ØµÙ†Ø¯ÙˆÙ‚ Ø«Ø§Ø¨Øª Ø§Ù„Ø­Ø¬Ù… Ø¯Ø§Ø¦Ù…Ø§Ù‹
  ctx.fillStyle='rgba(255,255,255,0.02)';
  rr(ctx,100,zoneY,W-200,zoneH,40);ctx.fill();

  if(showP && showC){
    // Ø§Ù„Ù†Ø³Ø¨Ø© + Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
    var cg=ctx.createRadialGradient(W/2,zoneY+120,0,W/2,zoneY+120,200);
    cg.addColorStop(0,'rgba('+pGlow.join(',')+',0.13)');cg.addColorStop(1,'transparent');
    ctx.fillStyle=cg;ctx.fillRect(0,0,W,H);
    ctx.fillStyle=pColor;ctx.font='900 190px Cairo, Arial';
    ctx.fillText(pct+'%',W/2,zoneY+190);
    ctx.fillStyle='rgba(255,255,255,0.5)';ctx.font='bold 40px Tajawal, Arial';
    ctx.fillText(ok+' ØµØ­ Ù…Ù† Ø£ØµÙ„ '+tot+' Ø³Ø¤Ø§Ù„',W/2,zoneY+258);

  } else if(showP && !showC){
    // Ø§Ù„Ù†Ø³Ø¨Ø© ÙÙ‚Ø· â€” ÙƒØ¨ÙŠØ±Ø© ÙÙŠ Ø§Ù„Ù…Ù†ØªØµÙ
    var cg2=ctx.createRadialGradient(W/2,zoneY+150,0,W/2,zoneY+150,200);
    cg2.addColorStop(0,'rgba('+pGlow.join(',')+',0.14)');cg2.addColorStop(1,'transparent');
    ctx.fillStyle=cg2;ctx.fillRect(0,0,W,H);
    ctx.fillStyle=pColor;ctx.font='900 210px Cairo, Arial';
    ctx.fillText(pct+'%',W/2,zoneY+215);

  } else if(!showP && showC){
    // Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙ‚Ø·
    ctx.fillStyle=pColor;ctx.font='900 130px Cairo, Arial';
    ctx.fillText(ok+'/'+tot,W/2,zoneY+165);
    ctx.fillStyle='rgba(255,255,255,0.45)';ctx.font='500 44px Tajawal, Arial';
    ctx.fillText('Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©',W/2,zoneY+235);

  } else {
    // Ù†Ø¬ÙˆÙ… Ø«Ù„Ø§Ø« ÙƒØ¨ÙŠØ±Ø©
    ctx.textAlign='center';
    ctx.font='110px serif';
    ctx.fillStyle='rgba(255,255,255,1)';
    ctx.fillText('ğŸŒŸ',W/2-170,zoneY+195);
    ctx.font='150px serif';
    ctx.fillText('â­ï¸',W/2,zoneY+210);
    ctx.font='110px serif';
    ctx.fillText('ğŸŒŸ',W/2+170,zoneY+195);
    ctx.fillStyle='rgba(196,181,253,0.7)';
    ctx.font='bold 42px Tajawal, Arial';
    ctx.fillText('Ø¬Ù„Ø³Ø© ØªØ¯Ø±ÙŠØ¨ Ù…ÙƒØªÙ…Ù„Ø© âœ“',W/2,zoneY+285);
  }

  // â”â”â” Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ â€” Ø«Ø§Ø¨Øª ØªØ­Øª Ø§Ù„Ø²ÙˆÙ† Ø¯Ø§Ø¦Ù…Ø§Ù‹ â”â”â”
  if(on('sName')){
    var nm=document.getElementById('nameVal').value.trim();
    if(nm){
      ctx.font='bold 42px Tajawal, Arial';
      var nmW=Math.min(ctx.measureText(nm).width+100,700);
      var nmY=zoneY+zoneH+40;
      ctx.fillStyle='rgba(99,102,241,0.13)';rr(ctx,W/2-nmW/2,nmY,nmW,80,40);ctx.fill();
      ctx.strokeStyle='rgba(99,102,241,0.28)';ctx.lineWidth=1;rr(ctx,W/2-nmW/2,nmY,nmW,80,40);ctx.stroke();
      ctx.fillStyle='rgba(255,255,255,0.78)';ctx.fillText(nm,W/2,nmY+50);
    }
  }

  // â”â”â” Ù‚Ø³Ù… Ø§Ù„Ø¯Ø¹ÙˆØ© â”â”â”
  var divY=1490;
  ctx.strokeStyle='rgba(139,92,246,0.14)';ctx.lineWidth=1;ctx.beginPath();ctx.moveTo(155,divY);ctx.lineTo(W-155,divY);ctx.stroke();

  // Ù†Ø¬Ù…Ø§Øª Ø²Ø®Ø±ÙÙŠØ©
  ctx.fillStyle='rgba(196,181,253,0.2)';ctx.font='28px Arial';
  ctx.fillText('âœ¦  âœ¦  âœ¦',W/2,divY+55);

  ctx.fillStyle='rgba(196,181,253,0.6)';ctx.font='700 36px Tajawal, Arial';
  ctx.fillText('ØªØ¯Ø±Ù‘Ø¨ Ù…Ø¹Ù‡Ù… Ø¹Ù„Ù‰',W/2,divY+120);

  // Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø§Ø±Ø²
  var siteGrad=ctx.createLinearGradient(W/2-250,0,W/2+250,0);
  siteGrad.addColorStop(0,'#a5b4fc');siteGrad.addColorStop(0.5,'#e0e7ff');siteGrad.addColorStop(1,'#c4b5fd');
  ctx.fillStyle=siteGrad;ctx.font='bold 58px Cairo, Arial';
  ctx.fillText('madarekelite.com',W/2,divY+196);

  ctx.fillStyle='rgba(196,181,253,0.22)';ctx.font='26px Tajawal, Arial';
  ctx.fillText('Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù‚Ø¯Ø±Ø§Øª ÙˆØ§Ù„ØªØ­ØµÙŠÙ„ÙŠ',W/2,divY+248);

  // Ø®Ø· Ø³ÙÙ„ÙŠ
  ctx.strokeStyle='rgba(139,92,246,0.1)';ctx.lineWidth=1;ctx.beginPath();ctx.moveTo(155,divY+286);ctx.lineTo(W-155,divY+286);ctx.stroke();

  // watermark
  ctx.fillStyle='rgba(196,181,253,0.09)';ctx.font='22px Tajawal, Arial';
  ctx.fillText('Ù…Ø¯Ø§Ø±Ùƒ Ø§Ù„Ù†Ø®Ø¨Ø© Â© 2026',W/2,1848);

  // Ù…Ø¹Ø§ÙŠÙ†Ø©
  var pv=document.getElementById('previewCanvas');pv.width=W;pv.height=H;
  pv.getContext('2d').drawImage(cv,0,0);
}

function dl(){document.getElementById('C').toBlob(function(b){var a=document.createElement('a');a.href=URL.createObjectURL(b);a.download='Ù†ØªÙŠØ¬ØªÙŠ-Ù…Ø¯Ø§Ø±Ùƒ.png';a.click();},'image/png');}
async function shareNative(){
  var btn=document.querySelector('.btn-main');
  btn.textContent='â³';
  document.getElementById('C').toBlob(async function(blob){
    var file=new File([blob],'Ù†ØªÙŠØ¬ØªÙŠ-Ù…Ø¯Ø§Ø±Ùƒ.png',{type:'image/png'});
    if(navigator.share && navigator.canShare && navigator.canShare({files:[file]})){
      try{
        await navigator.share({files:[file],title:'Ù†ØªÙŠØ¬ØªÙŠ Ø¹Ù„Ù‰ Ù…Ø¯Ø§Ø±Ùƒ Ø§Ù„Ù†Ø®Ø¨Ø©',text:'ØªØ¯Ø±Ù‘Ø¨ Ù…Ø¹ÙŠ Ø¹Ù„Ù‰ madarekelite.com'});
      }catch(e){}
    } else {
      // fallback â€” ØªÙ†Ø²ÙŠÙ„
      var a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='Ù†ØªÙŠØ¬ØªÙŠ-Ù…Ø¯Ø§Ø±Ùƒ.png';a.click();
    }
    btn.textContent='â†—ï¸ Ø´Ø§Ø±Ùƒ';
  },'image/png');
}

buildPhrases();
buildPhrases();
draw();
document.getElementById('nameVal').addEventListener('input',draw);
</script>
</body>
</html>
