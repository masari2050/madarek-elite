<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงุฎุชูุงุฑ ุงููุณู - ูุณุงุฑู</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        body { font-family: 'Tajawal', sans-serif; }
    </style>
</head>

<body class="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100">

    <!-- Header -->
    <header class="bg-white border-b border-slate-200">
        <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
            <a href="dashboard.html" class="text-slate-600 hover:text-slate-900 font-medium">โ ุงูุนูุฏุฉ ูููุญุฉ</a>
            <h1 class="text-2xl font-extrabold text-slate-900">ุงุฎุชุฑ ุงููุณู</h1>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 py-8">

        <div class="text-center mb-10">
            <h2 class="text-4xl font-extrabold text-slate-900 mb-3">ุงุฎุชุฑ ุงููุณู ููุชุฏุฑูุจ</h2>
            <p class="text-slate-600 text-lg">ุงุจุฏุฃ ุงูุชุฏุฑูุจ ูุจุงุดุฑุฉ ุญุณุจ ุงููุณู</p>
        </div>

        <!-- Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">

            <!-- Tahsili -->
            <div class="bg-white rounded-2xl p-8 shadow-lg border-2 border-purple-200">
                <div class="text-center mb-6">
                    <div class="w-20 h-20 bg-gradient-to-br from-purple-500 to-violet-500 rounded-2xl flex items-center justify-center text-4xl mx-auto mb-4">๐</div>
                    <h3 class="text-3xl font-bold text-gray-800 mb-2">ุงูุชุญุตููู</h3>
                    <p class="text-gray-600">ุงูููุงุฏ ุงูุฏุฑุงุณูุฉ</p>
                </div>

                <div class="space-y-2 mb-6 text-sm text-gray-700">
                    <div class="flex items-center gap-2"><span class="text-green-500">โ</span><span>ุงูุฑูุงุถูุงุช</span></div>
                    <div class="flex items-center gap-2"><span class="text-green-500">โ</span><span>ุงูููุฒูุงุก</span></div>
                    <div class="flex items-center gap-2"><span class="text-green-500">โ</span><span>ุงูููููุงุก</span></div>
                    <div class="flex items-center gap-2"><span class="text-green-500">โ</span><span>ุงูุฃุญูุงุก</span></div>
                </div>

                <div id="tahsiliStatus" class="bg-purple-50 rounded-lg p-3 text-center mb-4">
                    <p class="text-sm text-purple-700 font-semibold">ุฌุงุฑู ุชุญููู ุนุฏุฏ ุงูุฃุณุฆูุฉ...</p>
                </div>

                <button onclick="startTraining('tahsili')"
                    class="w-full bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-lg font-bold transition">
                    ุงุจุฏุฃ ุงูุชุฏุฑูุจ
                </button>
            </div>

            <!-- Verbal -->
            <div class="bg-white rounded-2xl p-8 shadow-lg border-2 border-green-200">
                <div class="text-center mb-6">
                    <div class="w-20 h-20 bg-gradient-to-br from-green-500 to-emerald-500 rounded-2xl flex items-center justify-center text-4xl mx-auto mb-4">๐</div>
                    <h3 class="text-3xl font-bold text-gray-800 mb-2">ูุฏุฑุงุช ููุธู</h3>
                    <p class="text-gray-600">ุงููุบุฉ ุงูุนุฑุจูุฉ</p>
                </div>

                <div class="space-y-2 mb-6 text-sm text-gray-700">
                    <div class="flex items-center gap-2"><span class="text-green-500">โ</span><span>ุงูุชูุงุธุฑ ุงูููุธู</span></div>
                    <div class="flex items-center gap-2"><span class="text-green-500">โ</span><span>ุฅููุงู ุงูุฌูู</span></div>
                    <div class="flex items-center gap-2"><span class="text-green-500">โ</span><span>ุงูุฎุทุฃ ุงูุณูุงูู</span></div>
                    <div class="flex items-center gap-2"><span class="text-green-500">โ</span><span>ุงูุงุณุชูุนุงุจ ุงูููุฑูุก</span></div>
                </div>

                <div id="verbalStatus" class="bg-green-50 rounded-lg p-3 text-center mb-4">
                    <p class="text-sm text-green-700 font-semibold">ุฌุงุฑู ุชุญููู ุนุฏุฏ ุงูุฃุณุฆูุฉ...</p>
                </div>

                <button onclick="startTraining('verbal')"
                    class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-bold transition">
                    ุงุจุฏุฃ ุงูุชุฏุฑูุจ
                </button>
            </div>

            <!-- Quant -->
            <div class="bg-white rounded-2xl p-8 shadow-lg border-2 border-blue-200">
                <div class="text-center mb-6">
                    <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-2xl flex items-center justify-center text-4xl mx-auto mb-4">๐</div>
                    <h3 class="text-3xl font-bold text-gray-800 mb-2">ูุฏุฑุงุช ููู</h3>
                    <p class="text-gray-600">ุงูุฑูุงุถูุงุช ูุงูุญุณุงุจ</p>
                </div>

                <div class="space-y-2 mb-6 text-sm text-gray-700">
                    <div class="flex items-center gap-2"><span class="text-green-500">โ</span><span>ุงูุฌุจุฑ ูุงููุนุงุฏูุงุช</span></div>
                    <div class="flex items-center gap-2"><span class="text-green-500">โ</span><span>ุงูููุฏุณุฉ</span></div>
                    <div class="flex items-center gap-2"><span class="text-green-500">โ</span><span>ุงููุณุจุฉ ูุงูุชูุงุณุจ</span></div>
                    <div class="flex items-center gap-2"><span class="text-green-500">โ</span><span>ุงูุฅุญุตุงุก</span></div>
                </div>

                <div id="quantStatus" class="bg-blue-50 rounded-lg p-3 text-center mb-4">
                    <p class="text-sm text-blue-700 font-semibold">ุฌุงุฑู ุชุญููู ุนุฏุฏ ุงูุฃุณุฆูุฉ...</p>
                </div>

                <button onclick="startTraining('quantitative')"
                    class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-bold transition">
                    ุงุจุฏุฃ ุงูุชุฏุฑูุจ
                </button>
            </div>

        </div>
    </main>

<script>
/* ===== Supabase ===== */
const sb = window.supabase.createClient(
    'https://czzcmbxejxbotjemyuqf.supabase.co',
    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN6emNtYnhlanhib3RqZW15dXFmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAxNzQ0ODEsImV4cCI6MjA4NTc1MDQ4MX0.xDfG1qsDZGyUrpL44JfqOtk57dVsLaMsvIzJz1KgiR0'
);

/* ===== Auth Guard ===== */
async function guardAuth() {
    const { data:{ session } } = await sb.auth.getSession();
    if (!session) window.location.href = 'login.html';
}

/* ===== Load Real Counts ===== */
/* ุบููุฑ ุงุณู ุงูุนููุฏ section ุฅุฐุง ุนูุฏู ุงุณู ูุฎุชูู */
async function loadCount(sectionName, statusId, colorClass) {
    const el = document.getElementById(statusId);

    try {
        const { count, error } = await sb
            .from('questions')
            .select('*', { count:'exact', head:true })
            .eq('section', sectionName);

        if (error) throw error;

        el.innerHTML =
            `<p class="text-sm ${colorClass} font-semibold">${count || 0} ุณุคุงู ูุชุงุญ</p>`;

    } catch (e) {
        el.innerHTML =
            `<p class="text-sm text-red-600 font-semibold">ุฎุทุฃ ูู ุฌูุจ ุงูุจูุงูุงุช</p>`;
    }
}

/* ===== Start Training ===== */
function startTraining(sectionName) {
    localStorage.setItem('masari_selected_section', sectionName);
    window.location.href = 'practice.html';
}

/* ===== Init ===== */
(async function init(){
    await guardAuth();

    await loadCount('tahsili', 'tahsiliStatus', 'text-purple-700');
    await loadCount('verbal', 'verbalStatus', 'text-green-700');
    await loadCount('quantitative', 'quantStatus', 'text-blue-700');
})();
</script>

</body>
</html>
